[{"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\index.js":"1","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\reportWebVitals.js":"2","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\store.js":"3","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\App.js":"4","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Login.js":"5","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\PrivateRoute.js":"6","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Panel.js":"7","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Equipos.js":"8","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Reglas\\Reglas.js":"9","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\index.js":"10","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Main.js":"11","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\MenuAcciones.js":"12","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\MapaOSM.js":"13","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Reglas\\Jobs.js":"14","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Reglas\\NuevaRegla.js":"15","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Reglas\\EditarRegla.js":"16","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Reglas\\VerUnidades.js":"17","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\actions\\usuarioActions.js":"18","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\services\\AuthService.js":"19","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\actions\\tareasActions.js":"20","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\actions\\unidadesActions.js":"21","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\actions\\CMDSActions.js":"22","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\actions\\gruposActions.js":"23","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\wialon\\session.js":"24","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\usuarioReducer.js":"25","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\tareasReducer.js":"26","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\unidadesReducer.js":"27","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\gruposReducer.js":"28","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\CMDSReducer.js":"29","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\components\\DesktopContainer.js":"30","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\UnidadesMapa.js":"31","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\config\\errores.js":"32","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\types\\index.js":"33","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Menu.js":"34","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\config\\CMDS.js":"35"},{"size":735,"mtime":1612279222562,"results":"36","hashOfConfig":"37"},{"size":375,"mtime":1612279222566,"results":"38","hashOfConfig":"37"},{"size":427,"mtime":1612279222569,"results":"39","hashOfConfig":"37"},{"size":878,"mtime":1614699118965,"results":"40","hashOfConfig":"37"},{"size":1590,"mtime":1614958089020,"results":"41","hashOfConfig":"37"},{"size":2651,"mtime":1614721880796,"results":"42","hashOfConfig":"37"},{"size":1482,"mtime":1614891357270,"results":"43","hashOfConfig":"37"},{"size":13558,"mtime":1614699876214,"results":"44","hashOfConfig":"37"},{"size":18352,"mtime":1614894137277,"results":"45","hashOfConfig":"37"},{"size":456,"mtime":1614699119002,"results":"46","hashOfConfig":"37"},{"size":357,"mtime":1612279222563,"results":"47","hashOfConfig":"37"},{"size":8635,"mtime":1614967888381,"results":"48","hashOfConfig":"37"},{"size":747,"mtime":1614890853650,"results":"49","hashOfConfig":"37"},{"size":2873,"mtime":1614882205460,"results":"50","hashOfConfig":"37"},{"size":6970,"mtime":1614814686345,"results":"51","hashOfConfig":"37"},{"size":8753,"mtime":1614707883934,"results":"52","hashOfConfig":"37"},{"size":7986,"mtime":1614699118990,"results":"53","hashOfConfig":"37"},{"size":901,"mtime":1614699118998,"results":"54","hashOfConfig":"37"},{"size":885,"mtime":1614699118992,"results":"55","hashOfConfig":"37"},{"size":7144,"mtime":1614881809246,"results":"56","hashOfConfig":"37"},{"size":1907,"mtime":1614699118996,"results":"57","hashOfConfig":"37"},{"size":1129,"mtime":1614699118993,"results":"58","hashOfConfig":"37"},{"size":5206,"mtime":1614699118994,"results":"59","hashOfConfig":"37"},{"size":28849,"mtime":1614892154799,"results":"60","hashOfConfig":"37"},{"size":1043,"mtime":1614876018854,"results":"61","hashOfConfig":"37"},{"size":3246,"mtime":1614882097116,"results":"62","hashOfConfig":"37"},{"size":1179,"mtime":1614699119003,"results":"63","hashOfConfig":"37"},{"size":1969,"mtime":1614699119001,"results":"64","hashOfConfig":"37"},{"size":826,"mtime":1614699118999,"results":"65","hashOfConfig":"37"},{"size":559,"mtime":1614699118966,"results":"66","hashOfConfig":"37"},{"size":4149,"mtime":1614898766370,"results":"67","hashOfConfig":"37"},{"size":2075,"mtime":1614699118967,"results":"68","hashOfConfig":"37"},{"size":2768,"mtime":1614880299668,"results":"69","hashOfConfig":"37"},{"size":3577,"mtime":1614968062439,"results":"70","hashOfConfig":"37"},{"size":452,"mtime":1614806210384,"results":"71","hashOfConfig":"37"},{"filePath":"72","messages":"73","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},"163ezq1",{"filePath":"75","messages":"76","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"77","messages":"78","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"79","messages":"80","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"81","messages":"82","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"83","usedDeprecatedRules":"74"},{"filePath":"84","messages":"85","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"86","usedDeprecatedRules":"74"},{"filePath":"87","messages":"88","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"89","usedDeprecatedRules":"74"},{"filePath":"90","messages":"91","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"92","usedDeprecatedRules":"74"},{"filePath":"93","messages":"94","errorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"95","usedDeprecatedRules":"74"},{"filePath":"96","messages":"97","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"98","messages":"99","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"100","messages":"101","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"102","messages":"103","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"104","messages":"105","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"106","messages":"107","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"108","messages":"109","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"110","usedDeprecatedRules":"74"},{"filePath":"111","messages":"112","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"113","usedDeprecatedRules":"74"},{"filePath":"114","messages":"115","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"116","messages":"117","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"118","messages":"119","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"120","messages":"121","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"122","messages":"123","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"124","messages":"125","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"126","messages":"127","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"128","usedDeprecatedRules":"74"},{"filePath":"129","messages":"130","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"131","messages":"132","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"133","messages":"134","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"135","messages":"136","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"137","messages":"138","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"139","messages":"140","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"141","messages":"142","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"143","usedDeprecatedRules":"74"},{"filePath":"144","messages":"145","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"146","messages":"147","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"148","messages":"149","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"150","messages":"151","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\index.js",[],["152","153"],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\reportWebVitals.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\store.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\App.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Login.js",["154"],"import React, { useEffect } from 'react';\r\nimport AuthService from \"../services/AuthService\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { saveTokenAction } from \"../store/actions/usuarioActions\";\r\n\r\n\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst Login = () => {\r\n\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    const token = AuthService.getToken();\r\n    if (token !== null) {\r\n      dispatch(saveTokenAction(token));\r\n      history.push('/');  \r\n    }\r\n  },[])\r\n\r\n  window.onmessage = function (e) {\r\n    var msg = e.data;\r\n    if (typeof msg == \"string\" && msg.indexOf(\"access_hash=\") >= 0) {\r\n      var token = msg.replace(\"access_hash=\", \"\");\r\n      AuthService.saveToken(token);\r\n      dispatch( saveTokenAction(token) );\r\n      history.push('/');\r\n    }\r\n    //acces_type:256\r\n  };\r\n  return (\r\n    <div>\r\n        <video id=\"myVideo\" autoPlay=\"true\" muted loop>\r\n          <source src=\"http://www.intralix.com/videos/Compress-transcode.mp4\" type=\"video/mp4\" />\r\n        </video>\r\n        <iframe\r\n        className=\"content\"\r\n        id=\"iframeInicio\"\r\n        src=\"http://gps.intralix.com/login.html?client_id=myApp&access_type=0xFFFFFFFF&activation_time=0&duration=604800&flags=0xFFFFFFFF&response_type=hash&redirect_uri=http://gps.intralix.com/post_token.html&css_url=https://cocky-brahmagupta-e971ac.netlify.app/login.css\"\r\n        title=\"Inline Frame Example\"\r\n        width=\"500\"\r\n        height=\"500\"\r\n        style={{border: \"transparent\"}}\r\n        ></iframe>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Login;\r\n","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\PrivateRoute.js",["155"],"import React, { useState } from 'react';\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Route, Redirect } from 'react-router-dom';\r\nimport wialon from \"../wialon/session\";\r\n\r\nimport AuthService from \"../services/AuthService\";\r\nimport { saveTokenAction, saveUserAction } from \"../store/actions/usuarioActions\";\r\nimport { getGroupsAction } from \"../store/actions/gruposActions\";\r\nimport { getUnitsAction } from \"../store/actions/unidadesActions\";\r\nimport { getJobsAction } from \"../store/actions/tareasActions\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { logoutAction } from \"../store/actions/usuarioActions\";\r\nimport { getCMDSUnitsAction } from \"../store/actions/CMDSActions\";\r\nimport preloader from \"../img/preloader.svg\";\r\n\r\nconst PrivateRoute = ({ component: Component}) => {\r\n\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n\r\n  let wialonObjeto = null;\r\n  const wialonLogin = (token) => {\r\n    wialonObjeto = new wialon(token);\r\n    let iniciar = new Promise((resolve, reject) => {\r\n      wialonObjeto.login( function(data) {\r\n        if (data.error) {\r\n          AuthService.logout();\r\n          dispatch( logoutAction() );\r\n          history.push('/login');\r\n            reject(\"¡Error\");\r\n        } else {\r\n            resolve(\"¡Éxito!\");\r\n        }\r\n      });\r\n\r\n    });\r\n    iniciar.then(() => {\r\n        wialonObjeto.showUnits();\r\n        dispatch(getJobsAction(wialonObjeto));\r\n        dispatch(saveUserAction(wialonObjeto));\r\n        dispatch(getGroupsAction(wialonObjeto));\r\n        dispatch(getUnitsAction(wialonObjeto));\r\n        dispatch(getCMDSUnitsAction(wialonObjeto));\r\n        setLoading(true);\r\n    });\r\n  }\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const loadingGrupos = useSelector(state => state.grupos.loading)\r\n  const loadingUnidades = useSelector(state => state.unidades.loading);\r\n  const loadingJobs = useSelector(state => state.tareas.loading);\r\n  const loadingCMDS = useSelector(state => state.CMDS.loading);\r\n\r\n  const [token] = useState( () => {\r\n    const token2 = AuthService.getToken();\r\n    console.log(\"entro\")\r\n    dispatch(saveTokenAction(token2));\r\n    wialonLogin(token2);\r\n    return token2;\r\n  });\r\n\r\n  return (\r\n    <Route render={\r\n        (props) => (\r\n          token !== null ? \r\n            loading && !loadingGrupos && !loadingUnidades && !loadingJobs && !loadingCMDS ?\r\n              <Component {...props} />\r\n              :\r\n              <img src={preloader} />\r\n          :\r\n            <Redirect to='/login' />\r\n    )} />\r\n\r\n  )\r\n}\r\nexport default PrivateRoute;\r\n//export default connect(mapStateToProps)(PrivateRoute)\r\n","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Panel.js",["156"],"import React, { useState } from 'react';\r\nimport Main from './Main';\r\nimport { useSelector } from \"react-redux\";\r\nimport MenuAcciones from \"./MenuAcciones\";\r\nimport MapaOSM from \"./MapaOSM\";\r\nconst Panel = () => {\r\n  const CMDSUnidades = useSelector(state => state.CMDS.unidadesCMDS);\r\n  let unidades = useSelector(state => state.unidades.unidades);\r\n  unidades = unidades.map(unidad => {\r\n      const unidadCcmd = CMDSUnidades.find(unidadcmd => unidadcmd.id === unidad.id);\r\n      if (unidadCcmd !== undefined) {\r\n          return unidad;\r\n      }\r\n  });\r\n  unidades= unidades.filter( unidad => unidad !== undefined);\r\n  const [ marketPosition, setMarketPosition] = useState( unidades[0] === undefined ? { lat : 0 ,lng : 0 } : { lat : unidades[0].pos.y,lng : unidades[0].pos.x })\r\n  const grupos = useSelector(state => state.grupos.grupos);\r\n  const [unidadesModal ] = useState(unidades);\r\n  const positionCurrentMarket = id => {\r\n      const unidad = unidadesModal.filter( unidad => unidad.id === id);\r\n      const { x, y } = unidad[0].pos;\r\n      setMarketPosition({lat:y,lng:x});\r\n  }\r\n  return (\r\n      <Main>\r\n          <div className='mapaInicio'>\r\n              <MapaOSM\r\n                  marketPosition={marketPosition}\r\n              />\r\n          </div>\r\n          <MenuAcciones\r\n              unidades={unidades}\r\n              grupos={grupos}\r\n              positionCurrentMarket={ positionCurrentMarket }\r\n          />\r\n      </Main>\r\n  );\r\n}\r\nexport default Panel;\r\n","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Equipos.js",["157","158","159","160"],"import React, { useState, useEffect } from 'react';\r\nimport Main from './Main';\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Card, Container, Row, Col, Form, Spinner } from 'react-bootstrap';\r\nimport { FaLock, FaSearch } from 'react-icons/fa';\r\nimport { addUnitsGroupAction, createGroupAction, deleteGroupAction } from \"../store/actions/gruposActions\";\r\n\r\nconst Equipos = () => {\r\n    const dispatch = useDispatch();\r\n    const unidades = useSelector(state => state.usuario.user.unidades);\r\n    const [unidadesModal,setUnidadesModal] = useState(useSelector(state => state.usuario.user.unidades)) \r\n    const grupos = useSelector(state => state.grupos.grupos);\r\n    const loadingEquipos = useSelector(state => state.grupos.loadingEquipos);\r\n    const wialonObject = useSelector(state => state.usuario.user);\r\n    const [ unidadesGrupo, setUnidadesGrupo ] = useState(grupos[0] === undefined ? [] : grupos[0].d.u);\r\n    const [ tituloGrupo, setTituloGrupo ] = useState(grupos[0] === undefined ? \"\" : grupos[0].d.nm);\r\n    const [ idGroup, setIdGroup] = useState(grupos[0] === undefined ? null : grupos[0].d.id);\r\n    const [ flagCreateGroup, setFlagCreateGroup ] = useState(false);\r\n    const [ cofirmDelete, setCofirmDelete ] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (!loadingEquipos) {\r\n            setFlagCreateGroup(false);\r\n            \r\n        }\r\n        if(!cofirmDelete){\r\n            setCofirmDelete(false);\r\n            //setTituloGrupo(grupos[0].d.nm);\r\n            //setUnidadesGrupo(grupos[0].d.u);\r\n        }\r\n    }, [grupos]);\r\n    const drag = e => {\r\n        e.dataTransfer.setData(\"text\", e.target.id);\r\n    }\r\n    const drop = e => {\r\n        e.preventDefault();\r\n        const data = e.dataTransfer.getData(\"text\");\r\n        var repite = unidadesGrupo.filter(unidad => parseInt(data) === unidad );\r\n        if (repite.length <= 0) {\r\n            setUnidadesGrupo([...unidadesGrupo,parseInt(data)]);\r\n        }\r\n        unidades.map(unidadGrupo => {\r\n            const UC = document.getElementById(\"checbokUnidadGrupo\" + unidadGrupo);\r\n            if (UC !== null) {\r\n                if (UC.checked) {\r\n                    repite = unidadesGrupo.filter(unidad => parseInt(unidadGrupo) === unidad );\r\n                    if (repite.length <= 0) {\r\n                        setUnidadesGrupo([...unidadesGrupo,parseInt(unidadGrupo)]);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n    const dropUnidades = e => {\r\n        e.preventDefault();\r\n        const data = e.dataTransfer.getData(\"text\");\r\n        let newGrupo = unidadesGrupo.filter(grupo => grupo !== parseInt(data) )\r\n        unidadesGrupo.map(unidad => {\r\n            const UC = document.getElementById(\"checbokUnidadGrupo\" + unidad).checked;\r\n            console.log(UC);\r\n            if (UC) {\r\n                newGrupo = newGrupo.filter(grupo => grupo !== parseInt(unidad) )\r\n            }\r\n        });\r\n        setUnidadesGrupo(newGrupo);\r\n    }\r\n    const allowDrop = e => {\r\n        e.preventDefault();\r\n    }\r\n    const selectGrupo = e => {\r\n        const se = document.getElementById(e.target.id);\r\n        const idGrupo = se.options[se.selectedIndex].id;\r\n        const newGrupo = grupos.filter(grupo => grupo.d.id === parseInt(idGrupo) )\r\n        setUnidadesGrupo(newGrupo[0].d.u);\r\n        setTituloGrupo(newGrupo[0].d.nm);\r\n        setIdGroup(newGrupo[0].d.id);\r\n    };\r\n    const addUnitsGroup = e => {\r\n        e.preventDefault();\r\n        dispatch(addUnitsGroupAction(unidadesGrupo,idGroup,wialonObject));\r\n    }\r\n    const addGroupModal = e => {\r\n        e.preventDefault();\r\n        setFlagCreateGroup(true);\r\n        setTituloGrupo(\"\");\r\n        setUnidadesGrupo([]);\r\n    }\r\n    const cancelGroup = e => {\r\n        e.preventDefault();\r\n        setFlagCreateGroup(false);\r\n        setTituloGrupo(grupos[0].d.nm);\r\n        setUnidadesGrupo(grupos[0].d.u);\r\n    }\r\n    const nameGroupChange = e => {\r\n        e.preventDefault();\r\n        setTituloGrupo(e.target.value);\r\n    }\r\n    const addGroup = e => {\r\n        e.preventDefault();\r\n        dispatch(createGroupAction(unidadesGrupo,tituloGrupo,wialonObject));\r\n    }\r\n    const confirmDelete = e => {\r\n        e.preventDefault();\r\n        setCofirmDelete(true);\r\n    }\r\n    const cancelDelete = e => {\r\n        e.preventDefault();\r\n        setCofirmDelete(false);\r\n    }\r\n    const deleteGroup = e => {\r\n        e.preventDefault();\r\n        dispatch(deleteGroupAction(idGroup,wialonObject));\r\n        setCofirmDelete(false);\r\n    }\r\n    const buscarUnidad = e => {\r\n        e.preventDefault();\r\n        const nombre = e.target.value.toUpperCase();\r\n        const arrayUnidades = [];\r\n        let tempUnidades = unidades;\r\n        tempUnidades.map(unidad => \r\n            {\r\n                if(unidad.nm.toUpperCase().search(nombre) !== -1){\r\n                    arrayUnidades.push({\r\n                        id: unidad.id,\r\n                        nm: unidad.nm\r\n                    });\r\n                }\r\n            }\r\n        );\r\n        setUnidadesModal(arrayUnidades);\r\n    }\r\n    return (\r\n        <Main>\r\n            <Card className=\"text-center\">\r\n                <Card.Header>Grupos</Card.Header>\r\n                <Card.Body>\r\n                    <Card.Title>\r\n                        {\r\n                            tituloGrupo\r\n                        }\r\n                    </Card.Title>\r\n                    <Container>\r\n                        <Row style={{marginBottom:\"20px\"}}>\r\n                            <Col>\r\n                                {\r\n                                    flagCreateGroup ?\r\n                                        <input \r\n                                            id=\"inputGroup-sizing-sm\" \r\n                                            placeholder=\"Nombre del grupo\" \r\n                                            className=\"inputBlack\" \r\n                                            onChange={ e => nameGroupChange(e) }\r\n                                        />\r\n                                    :\r\n                                        (<Form>\r\n                                            <Form.Group controlId=\"exampleForm.SelectCustom\">\r\n                                                <Form.Label>Grupos</Form.Label>\r\n                                                <Form.Control as=\"select\" custom\r\n                                                    onChange={ e => selectGrupo(e) }\r\n                                                >\r\n                                                {\r\n                                                    grupos.map(grupo => (\r\n                                                        <option key={grupo.d.id} id={grupo.d.id} >{grupo.d.nm}</option>\r\n                                                    ))\r\n                                                }\r\n                                                </Form.Control>\r\n                                            </Form.Group>\r\n                                        </Form>)\r\n                                }\r\n                            </Col>\r\n                            <Col>\r\n                                {\r\n                                    flagCreateGroup ?\r\n                                        null\r\n                                    :\r\n                                        <button onClick={ e => confirmDelete(e) }>Eliminar grupo</button>\r\n                                }\r\n                            </Col>\r\n                            <Col>\r\n                                {\r\n                                    flagCreateGroup ?\r\n                                        <button onClick={e => cancelGroup(e) }>Cancelar</button>\r\n                                    :\r\n                                        <button onClick={ e => addGroupModal(e) }>Crear Grupo</button>\r\n                                }\r\n                            </Col>\r\n                        </Row>\r\n                        <Row>\r\n                            <Col onDrop={(e) => dropUnidades(e)} onDragOver={(e) => allowDrop(e)}>\r\n                                <Card>\r\n                                    <Card.Header>Unidades Disponibles</Card.Header>\r\n                                    <Card.Body style={{ maxHeight:\"500px\", overflowY:\"auto\"}} >\r\n                                        <Card.Title><input onChange={ e => buscarUnidad(e) } id=\"inputGroup-sizing-sm\" className=\"inputBlack\" /><FaSearch /></Card.Title>\r\n                                        <div id=\"UnidadesDiv\">\r\n                                            {\r\n                                                unidadesModal.map(unidad => (\r\n                                                    <div \r\n                                                        key={\"U\" + unidad.id} \r\n                                                        id={unidad.id} \r\n                                                        draggable=\"true\" \r\n                                                        style={{cursor: \"pointer\", borderStyle:\"outset\", marginTop:\"5px\"}} \r\n                                                        onDragStart={e => drag(e)} \r\n                                                    >\r\n                                                        <span><FaLock size={20} /> Unidad: {unidad.nm}</span>\r\n                                                        <input className=\"checbokUnidad\" type=\"checkbox\"  />\r\n                                                        <br></br>\r\n                                                    </div>\r\n                                                ))\r\n                                            }\r\n                                        </div>\r\n                                    </Card.Body>\r\n                                </Card>\r\n                            </Col>\r\n                            <Col onDrop={(e) => drop(e)} onDragOver={(e) => allowDrop(e)}>\r\n                                <Card >\r\n                                    <Card.Header>Unidades Grupo: {tituloGrupo}</Card.Header>\r\n                                    <Card.Body style={{ maxHeight:\"500px\", overflowY:\"auto\"}} >\r\n                                        <div id=\"GrupoDiv\" >\r\n                                            {\r\n                                                unidadesGrupo.map(unidad => (\r\n                                                    <div \r\n                                                        key={\"G\"+unidad} \r\n                                                        id={unidad} \r\n                                                        draggable=\"true\" \r\n                                                        style={{cursor: \"pointer\", borderStyle:\"outset\", marginTop:\"5px\"}} \r\n                                                        onDragStart={e => drag(e)} \r\n                                                    >\r\n                                                        <span><FaLock size={20} /> Unidad: {(unidades.filter(unidad2 => unidad === unidad2.id))[0].nm}</span>\r\n                                                        <input className=\"checbokUnidad\" id={\"checbokUnidadGrupo\"+unidad} type=\"checkbox\"  />\r\n                                                        <br></br>\r\n                                                    </div>\r\n                                                ))\r\n                                            }\r\n                                        </div>\r\n                                    </Card.Body>\r\n                                    <Card.Footer>\r\n                                        {\r\n                                            flagCreateGroup ?\r\n                                                <button style={{float:\"right\"}} onClick={e => addGroup(e)}>Guardar grupo</button>\r\n                                            :\r\n                                                <button style={{float:\"right\"}} onClick={e => addUnitsGroup(e)}>Guardar</button>\r\n                                        }\r\n                                    </Card.Footer>\r\n                                </Card>\r\n                            </Col>\r\n                        </Row>\r\n                        </Container>\r\n                </Card.Body>\r\n                <Card.Footer className=\"text-muted\">Intralix</Card.Footer>\r\n            </Card>\r\n            {\r\n                loadingEquipos ?\r\n                    <Container className=\"popoverPanale\">\r\n                        <Spinner animation=\"border\" role=\"status\" style={{margin: \"50px\"}}>\r\n                            <span className=\"sr-only\">Loading...</span>\r\n                        </Spinner>\r\n                    </Container>\r\n                :\r\n                    null\r\n            }\r\n            {\r\n                cofirmDelete ? \r\n                    <Container className=\"popoverPanale\">\r\n                        <Card style={{ width: '18rem', marginTop:\"10px\" }}>\r\n                            <Card.Body>\r\n                                <Card.Text>Se eliminara el grupo <b>{tituloGrupo}</b></Card.Text>\r\n                                <button style={{float:\"right\"}} onClick={ e => deleteGroup(e) } >Confirmar</button>\r\n                                <button style={{float:\"left\"}} onClick={ e => cancelDelete(e) }>Cancelar</button>\r\n                            </Card.Body>\r\n                        </Card>\r\n                    </Container>\r\n                :\r\n                    null\r\n            }\r\n        </Main>     \r\n    );\r\n}\r\n \r\nexport default Equipos;\r\n","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Reglas\\Reglas.js",["161","162","163","164","165","166","167","168","169","170","171"],"import React, { useState, useEffect } from 'react';\r\nimport { Accordion, Card, Button, Container, Row, Col } from 'react-bootstrap';\r\nimport { FaLock, FaSearch, FaArrowAltCircleDown, FaTasks } from 'react-icons/fa';\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\n\r\nimport NuevaRegla from \"./NuevaRegla\";\r\nimport Jobs from \"./Jobs\";\r\nimport VerUnidades from \"./VerUnidades\";\r\nimport EditarRegla from \"./EditarRegla\";\r\nimport Main from '../Main';\r\n\r\nimport { CMDSDefault } from \"../../config/CMDS\";\r\nimport { createJobAction, deleteJobAction, activateJobsAction, deactivateJobsAction } from \"../../store/actions/tareasActions\";\r\nimport preloader from \"../../img/preloader.svg\";\r\nconst Reglas = () => {\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const loading = useSelector(state => state.tareas.loadingData)\r\n    const usuario =  useSelector(state => state.usuario);\r\n    let unidades = useSelector(state => state.unidades.unidades);\r\n    const CMDSUnidades = useSelector(state => state.CMDS.unidadesCMDS)\r\n    let grupos = useSelector(state => state.grupos.grupos);\r\n    const gruposFiltrados = grupos => {\r\n        const newGR = grupos.map( grupo => {\r\n            let nuevasUnidades = grupo.d.u.map(Uni => {\r\n                const unidadCcmd = CMDSUnidades.find(unidad => Uni === unidad.id);\r\n                if (unidadCcmd !== undefined) {\r\n                    return Uni;\r\n                }\r\n            });\r\n            nuevasUnidades = nuevasUnidades.filter( uni => uni !== undefined);\r\n            //console.log(nuevasUnidades);\r\n            if (nuevasUnidades.length > 0) {\r\n                grupo.d.u = nuevasUnidades;\r\n                return grupo;\r\n            }\r\n        });\r\n        //console.log(newGR);\r\n        const gruposFiltrados = newGR.filter(grupo => grupo !== undefined)\r\n        return gruposFiltrados;\r\n    };\r\n    grupos = gruposFiltrados(grupos);\r\n    console.log(grupos);\r\n    const [gruposModal, setGruposModal] = useState(grupos);\r\n    const [nuevaRegla, setNuevaRegla] = useState(false);\r\n    const jobs = useSelector(state => state.tareas.tareas)\r\n    const [jobsModal, setJobsModal] = useState([]);\r\n    const [verUnidades, setVerunidades] = useState(false);\r\n    //const [unidadesJob, setUnidadesJob] = useState([]);\r\n    const [jobId,setJobId] = useState(0);\r\n    const [editarRegla, setEditarRegla] = useState(false);\r\n    const [comandoNuevaRegla, setComandoNuevaRegla] = useState(\"Posición\");\r\n    const [unidadesCheck,setUnidadesCheck] = useState([]);\r\n    const wialonObject = useSelector(state => state.usuario.user);\r\n\r\n    useEffect(() => {\r\n        jobsModal.forEach(jobModal => {\r\n            const found = jobs.find(job => job.id === jobModal.id );\r\n            if (!found) {\r\n                setJobsModal(jobsModal.filter(jobModal2 => jobModal.id !== jobModal2.id));\r\n            }\r\n        });\r\n    }, [jobs]);\r\n    const addUnitNewJob = (tarea) => {\r\n        console.log(tarea);\r\n        tarea.unidades = unidadesCheck;\r\n        const CurrentCMD = CMDSDefault.find(cmd => cmd.cmd_name === tarea.cmd);\r\n        tarea.cmd = CurrentCMD;\r\n        //wialonObject.createNewJob(tarea);\r\n        dispatch(createJobAction(tarea,wialonObject));\r\n    }\r\n    const filtrarUnidadesComando = (e,comando) => {\r\n        const CurrentCMD = CMDSDefault.find(cmd => cmd.cmd_name === comando);\r\n        console.log(CurrentCMD)\r\n        grupos.forEach(grupo => {\r\n            grupo.d.u.forEach(unidad => {\r\n                var total = document.getElementsByName(unidad + \"SpanGrupoTareas\").length;\r\n                for(var i=0;i<total;i++){\r\n                    const domElement = document.getElementsByName(unidad + \"SpanGrupoTareas\")[i];\r\n                    domElement.style.color = \"black\";\r\n                }\r\n                var total = document.getElementsByName(unidad + \"checkbox\").length;\r\n                for(var i=0;i<total;i++){\r\n                    document.getElementsByName(unidad + \"checkbox\")[i].disabled = false;\r\n                }\r\n            });\r\n        });\r\n\r\n        let arrayUnidadesCBF = unidadesCheck;\r\n        grupos.forEach(grupo => {\r\n            grupo.d.u.forEach(unidad => {\r\n                const foundUnidadCMDS = CMDSUnidades.find(cmdsunidad => cmdsunidad.id === unidad);\r\n                if (foundUnidadCMDS) {\r\n                    console.log(foundUnidadCMDS);\r\n                    const found = foundUnidadCMDS.cmds.find(cmd => cmd.n === CurrentCMD.cmd_name && CurrentCMD.cmd_type === cmd.c);\r\n                    if (!found) {\r\n                        arrayUnidadesCBF = arrayUnidadesCBF.filter( unidadCB => unidadCB !== foundUnidadCMDS.id)\r\n                        var total = document.getElementsByName(unidad + \"SpanGrupoTareas\").length;\r\n                        for(var i=0;i<total;i++){\r\n                            const domElement = document.getElementsByName(unidad + \"SpanGrupoTareas\")[i];\r\n                            domElement.style.color = \"red\";\r\n                        }\r\n                        var total = document.getElementsByName(unidad + \"checkbox\").length;\r\n                        for(var i=0;i<total;i++){\r\n                            document.getElementsByName(unidad + \"checkbox\")[i].checked = false;\r\n                            document.getElementsByName(unidad + \"checkbox\")[i].disabled = true;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        setUnidadesCheck(arrayUnidadesCBF);\r\n        setComandoNuevaRegla(CurrentCMD);\r\n    }\r\n    const buscarUnidad = e => {\r\n        e.preventDefault();\r\n        const nombre = e.target.value.toUpperCase();\r\n        const arrayGrupos = [];\r\n        let tempGrupos = grupos;\r\n        tempGrupos.forEach(grupo => {\r\n            const arrayunidades = [];\r\n            grupo.d.u.forEach(unidadGrupo => {\r\n                unidades.forEach(unidad => {\r\n                    if (unidadGrupo === unidad.id) {\r\n                        if(unidad.nm.toUpperCase().search(nombre) !== -1){\r\n                            arrayunidades.push(unidadGrupo);\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n            arrayGrupos.push({\r\n                f: grupo.f,\r\n                i: grupo.i,\r\n                d:{\r\n                cls: grupo.d.cls,\r\n                id:grupo.d.id,\r\n                mu: grupo.d.mu,\r\n                nm: grupo.d.nm,\r\n                u:arrayunidades\r\n                }\r\n            });\r\n        });\r\n        setGruposModal(arrayGrupos);\r\n    }\r\n    const addDevice = e => {\r\n        var total = document.getElementsByName(e.target.id).length;\r\n        for(var i=0;i<total;i++){\r\n            document.getElementsByName(e.target.id)[i].checked = e.target.checked;\r\n        }\r\n        const CCB = document.getElementById(e.target.id);\r\n        console.log(e.target.id);\r\n        console.log(e.target.id.replace(\"checkbox\", \"\"))\r\n        const NUC = parseInt(e.target.id.replace(\"checkbox\", \"\"));\r\n        if (CCB.checked) {\r\n            setUnidadesCheck([...unidadesCheck,NUC]);\r\n        }else{\r\n            setUnidadesCheck(unidadesCheck.filter( unidadCB => unidadCB !== NUC))\r\n        }\r\n        //agregar unidades\r\n    }\r\n    const addAllDevices = (e,grupo) => {\r\n        console.log(grupo);\r\n        let arrayUnidadesCB = [];\r\n        grupo.d.u.map(unidad => {\r\n            var total=document.getElementsByName(unidad + \"checkbox\").length;\r\n            for(var i=0;i<total;i++){\r\n                if(!document.getElementsByName(unidad + \"checkbox\")[i].disabled){\r\n                    document.getElementsByName(unidad + \"checkbox\")[i].checked = e.target.checked;\r\n                }\r\n            }\r\n            const VCB = unidadesCheck.filter(unidadCB => unidad === unidadCB );\r\n            if (VCB.length <= 0) {\r\n                if(!document.getElementsByName(unidad + \"checkbox\")[0].disabled){\r\n                    arrayUnidadesCB.push(unidad);\r\n                }\r\n            }\r\n        })\r\n        if (e.target.checked) {\r\n            arrayUnidadesCB = unidadesCheck.concat(arrayUnidadesCB);\r\n            setUnidadesCheck(arrayUnidadesCB);\r\n        }else{\r\n            arrayUnidadesCB = unidadesCheck;\r\n            grupo.d.u.forEach(unidad => {\r\n                arrayUnidadesCB = arrayUnidadesCB.filter( unidadCB => unidadCB !== unidad)\r\n            });\r\n            console.log(arrayUnidadesCB);\r\n            setUnidadesCheck(arrayUnidadesCB);\r\n        }\r\n    }\r\n    const confirmNuevaRegla = e => {\r\n        e.preventDefault();\r\n        setJobsModal([]);\r\n        filtrarUnidadesComando(null,\"Posición\");\r\n        setNuevaRegla(true);\r\n    }\r\n    const showJobsUnit = (e,unidad) => {\r\n        e.preventDefault();\r\n        console.log(unidad)\r\n        let jobsModalTemp = [];\r\n        jobs.forEach(job => {\r\n            let flag = false;\r\n            job.unidades.forEach(unidadJob => {\r\n                if (unidadJob === unidad) {\r\n                    flag = true;\r\n                }\r\n            });\r\n            if (flag) {\r\n                jobsModalTemp.push(job);\r\n            }\r\n        });\r\n        console.log(jobsModalTemp);\r\n        setJobsModal(jobsModalTemp);\r\n    }\r\n    const showJobsGroup = (e,groupId) => {\r\n        e.preventDefault();\r\n        const currentGroup = grupos.filter(grupo => (grupo.d.id === groupId));\r\n        console.log(currentGroup);\r\n        let jobsModalTemp = [];\r\n        jobs.forEach(job => {\r\n            let flag = false;\r\n            job.unidades.forEach(unidadJob => {\r\n                currentGroup[0].d.u.forEach(unidadesG => {\r\n                    if (unidadJob === unidadesG) {\r\n                        flag = true;\r\n                    }\r\n                });\r\n            });\r\n            if (flag) {\r\n                jobsModalTemp.push(job);\r\n            }\r\n        });\r\n        console.log(jobsModalTemp);\r\n        setJobsModal(jobsModalTemp);\r\n    }\r\n    const unitsJobs = (e,jobId) => {\r\n        e.preventDefault();\r\n        console.log(jobId);\r\n        const unidadesJob = [];\r\n        jobsModal.forEach(job => {\r\n            if (job.id === jobId) {\r\n                job.unidades.forEach(jobU => {\r\n                    const unidad = unidades.filter(unidad => jobU === unidad.id);\r\n                    console.log(unidad)\r\n                    unidadesJob.push({id: unidad[0].id,nm: unidad[0].nm});\r\n                });\r\n            }\r\n        });\r\n        console.log(unidadesJob);\r\n        setJobId(jobId);\r\n        //setUnidadesJob(unidadesJob);\r\n        setVerunidades(true);\r\n    }\r\n    const editJob = (e,jobId) => {\r\n        e.preventDefault();\r\n        setJobId(jobId);\r\n        setEditarRegla(true);\r\n    }\r\n    const deleteJob = (e,jobId) => {\r\n        e.preventDefault();\r\n        console.log(jobId);\r\n        dispatch( deleteJobAction(jobId,wialonObject) );\r\n    }\r\n    const activateJob = (e,jobId) => {\r\n        e.preventDefault();\r\n        console.log(jobId);\r\n        dispatch( activateJobsAction(jobId, wialonObject) )\r\n    }\r\n    const deactivateJob = (e,jobId) => {\r\n        e.preventDefault();\r\n        console.log(jobId);\r\n        dispatch( deactivateJobsAction(jobId, wialonObject) )\r\n    }\r\n    return (\r\n        <Main>\r\n            <Container className=\"containerReglas\">\r\n                <Row>\r\n                    <Col xs lg=\"6\">\r\n                        {\r\n                            !verUnidades ?\r\n                                <Card>\r\n                                    <Card.Body style={{overflowY:\"auto\"}} >\r\n                                        <Card.Title style={{ margin:\"10px 0 10px 0\", textAlign:\"-webkit-right\"}}>\r\n                                            <button onClick={ e => confirmNuevaRegla(e) }>Nueva regla</button>\r\n                                        </Card.Title>\r\n                                        <Card.Title style={{ margin:\"10px 0 10px 0\" }}>\r\n                                            <input onChange={ e => buscarUnidad(e) } id=\"inputGroup-sizing-sm\" className=\"inputBlack\" /><FaSearch />\r\n                                        </Card.Title>\r\n                                        <div style={{overflowY:\"auto\",height: \"800px\"}}>\r\n                                        {\r\n                                            gruposModal.length > 0 ?\r\n                                                gruposModal.map(grupo => (\r\n                                                    grupo.d.u.length > 0 ?\r\n                                                    (\r\n                                                        <Accordion key={grupo.d.id + \"G\"} defaultActiveKey=\"0\">\r\n                                                        <Card>\r\n                                                            <Card.Header style={{textAlign:\"left\"}}>\r\n                                                                <Accordion.Toggle as={Button} variant=\"link\" eventKey=\"1\">\r\n                                                                    <FaArrowAltCircleDown />{grupo.d.nm}\r\n                                                                </Accordion.Toggle>\r\n                                                                <span><FaTasks onClick={e => showJobsGroup(e,grupo.d.id)}></FaTasks></span>\r\n                                                                <input className=\"checbokGroup\" type=\"checkbox\" id={grupo.d.id + \"checkbox\"} onChange={ (e) => addAllDevices(e,grupo) } />\r\n                                                            </Card.Header>\r\n                                                            <Accordion.Collapse eventKey=\"1\">\r\n                                                                {/**Todas las unidades del grupo */}\r\n                                                                <Card.Body style={{padding: \"10px 10px 10px 45px\", color: \"#000000\", textAlign:\"left\" }}>\r\n                                                                    {\r\n                                                                        grupo.d.u.map(unidad => (\r\n                                                                            <span key={unidad + \"MA\"} style={{cursor: \"pointer\"}} >\r\n                                                                            <span name={unidad+\"SpanGrupoTareas\"} ><FaLock size={20} /> Unidad:\r\n                                                                                {\r\n                                                                                    (unidades.filter(unidad2 => unidad === unidad2.id))[0].nm\r\n                                                                                }\r\n                                                                            </span>\r\n                                                                            <FaTasks onClick={e => showJobsUnit(e,unidad)}></FaTasks>\r\n                                                                            <input className=\"checbokUnidad\" type=\"checkbox\" id={unidad + \"checkbox\"} name={unidad + \"checkbox\"} onChange={ e => addDevice(e) } />\r\n                                                                            <br></br>\r\n                                                                            </span>\r\n                                                                        ))\r\n                                                                    }\r\n                                                                </Card.Body>\r\n                                                            </Accordion.Collapse>\r\n                                                        </Card>\r\n                                                        </Accordion>\r\n                                                    )\r\n                                                    :\r\n                                                        null\r\n                                                ))\r\n                                            :\r\n                                                null\r\n                                        }\r\n                                        </div>\r\n                                    </Card.Body>\r\n                                </Card>\r\n                            :\r\n                                null\r\n                        }\r\n                    </Col>\r\n                    <Col xs lg=\"6\" >\r\n                    {\r\n                        nuevaRegla ?\r\n                            <NuevaRegla\r\n                                setNuevaRegla={setNuevaRegla}\r\n                                filtrarUnidadesComando={filtrarUnidadesComando}\r\n                                addUnitNewJob={addUnitNewJob}\r\n                            />\r\n                        :\r\n                            null\r\n                    }\r\n                    {\r\n                        jobsModal.length > 0 ?\r\n                            <Jobs\r\n                                unitsJobs={unitsJobs}\r\n                                jobsModal={jobsModal}\r\n                                editJob={editJob}\r\n                                deleteJob={deleteJob}\r\n                                activateJob={activateJob}\r\n                                deactivateJob={deactivateJob}\r\n                            />\r\n                        :\r\n                            null\r\n                    }\r\n                    {\r\n                        verUnidades ?\r\n                            <VerUnidades\r\n                                setVerunidades={setVerunidades}\r\n                                jobId={jobId}\r\n                            />\r\n                        :\r\n                            null\r\n                    }\r\n                    {\r\n                        editarRegla ?\r\n                        <EditarRegla\r\n                            jobId={jobId}\r\n                            setEditarRegla={setEditarRegla}\r\n                        />\r\n                        :\r\n                        null\r\n                    }\r\n                    {\r\n                        loading ?\r\n                        <Container className=\"popoverPanale\">\r\n                            <img src={preloader} />\r\n                        </Container>\r\n                        :null\r\n                    }\r\n                    </Col>\r\n                </Row>\r\n            </Container>\r\n        </Main>\r\n    );\r\n}\r\nexport default Reglas;","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\index.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Main.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\MenuAcciones.js",["172","173","174"],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\MapaOSM.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Reglas\\Jobs.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Reglas\\NuevaRegla.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Reglas\\EditarRegla.js",["175"],"import React, { useState, useEffect } from 'react';\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { Card, Container, Row, Col, Table, Form } from 'react-bootstrap';\r\nimport DatePicker from \"react-datepicker\";\r\nimport { updateJobAction } from \"../../store/actions/tareasActions\";\r\n\r\nconst EditarRegla = ({jobId,setEditarRegla}) => {\r\n    const dispatch = useDispatch();\r\n    const jobs = useSelector(state => state.tareas.tareas);\r\n    const job = jobs.filter(job => job.id === parseInt(jobId))[0];\r\n    const [nombreTarea, setNombreRegla] = useState(\"\")\r\n    const [startDateHora, setStartDateHora] = useState(new Date());\r\n    const [startDate, setStartDate] = useState(new Date());\r\n    const [toggleDate, setToggleDate] = useState(true);\r\n    const wialonObject = useSelector(state => state.usuario.user);\r\n    useEffect(() => {\r\n        if (job !== undefined && job !== null) {\r\n            setNombreRegla(job.nombre);\r\n            setStartDateHora(new Date(\"0 \"+job.hora));\r\n\r\n            document.getElementById(\"SelectComandoEditarRegla\").value  = \"Cerrar\";\r\n            if (job.dias.length > 0) {\r\n                setToggleDate(true);\r\n                job.dias.forEach(dia => {\r\n                    document.getElementById(\"EditarReglaCheckbox\"+dia).checked = true;\r\n                });\r\n            }else{\r\n                setToggleDate(false);\r\n                setStartDate(new Date(job.fecha));\r\n            }\r\n        }\r\n    }, []);\r\n    const updateJob = (e) => {\r\n        e.preventDefault();\r\n        const Hora = addZero(startDateHora.getHours())+\":\"+addZero(startDateHora.getMinutes())\r\n        const nuevaTarea = {\r\n            jobId,\r\n            nombreTarea,\r\n            Hora,\r\n            arrayNuevosDias:null,\r\n            fecha:null\r\n        }\r\n        console.log(jobId);\r\n        console.log(nombreTarea);\r\n        console.log(addZero(startDateHora.getHours())+\":\"+addZero(startDateHora.getMinutes()));\r\n        console.log(toggleDate);\r\n        if (toggleDate) {\r\n            //dias\r\n            const arrayNuevosDias = [];\r\n            if(document.getElementById(\"EditarReglaCheckboxLunes\").checked)  arrayNuevosDias.push(\"Lunes\");\r\n            if(document.getElementById(\"EditarReglaCheckboxMartes\").checked)  arrayNuevosDias.push(\"Martes\");\r\n            if(document.getElementById(\"EditarReglaCheckboxMiercoles\").checked)  arrayNuevosDias.push(\"Miercoles\");\r\n            if(document.getElementById(\"EditarReglaCheckboxJueves\").checked)  arrayNuevosDias.push(\"Jueves\");\r\n            if(document.getElementById(\"EditarReglaCheckboxViernes\").checked)  arrayNuevosDias.push(\"Viernes\");\r\n            if(document.getElementById(\"EditarReglaCheckboxSabado\").checked)  arrayNuevosDias.push(\"Sabado\");\r\n            if(document.getElementById(\"EditarReglaCheckboxDomingo\").checked)  arrayNuevosDias.push(\"Domingo\");\r\n            console.log(arrayNuevosDias);\r\n            nuevaTarea.arrayNuevosDias=arrayNuevosDias;\r\n        } else {\r\n            //fecha exacta\r\n            console.log(startDate)\r\n            const fecha  = startDate.getTime()/1000;\r\n            console.log(fecha);\r\n            nuevaTarea.fecha = fecha;\r\n        }\r\n        console.log(nuevaTarea);\r\n        dispatch( updateJobAction(jobId,nuevaTarea,wialonObject) );\r\n    }\r\n    function addZero(i){\r\n        if (i < 10) {\r\n            i = \"0\" + i;\r\n        }\r\n        return i;\r\n    }\r\n    return (\r\n        <>\r\n            {\r\n                job !== undefined && job !== null ?\r\n                    <Container className=\"\">\r\n                        <Card >\r\n                            <Card.Body>\r\n                                <Card.Text>{job.nombre}</Card.Text>\r\n                                <Row>\r\n                                    <Col xs lg=\"4\">\r\n                                        <input id=\"\" style={{inlineSize:\"inherit\"}} className=\"inputBlack\" placeholder=\"Nombre\" onChange={e => setNombreRegla(e.target.value)} value={nombreTarea} />\r\n                                    </Col>\r\n                                    <Col xs lg=\"4\">\r\n                                        <DatePicker\r\n                                            className=\"inputBlack\"\r\n                                            selected={startDateHora}\r\n                                            onChange={date => setStartDateHora(date)}\r\n                                            showTimeSelect\r\n                                            showTimeSelectOnly\r\n                                            timeIntervals={15}\r\n                                            timeCaption=\"Time\"\r\n                                            dateFormat=\"HH:mm\"\r\n                                        />\r\n                                    </Col>\r\n                                    <Col xs lg=\"4\">\r\n                                        <Form>\r\n                                            <Form.Group controlId=\"SelectComandoEditarRegla\">\r\n                                                <Form.Control as=\"select\" custom>\r\n                                                    <option>Abrir</option>\r\n                                                    <option>Cerrar</option>\r\n                                                    <option>Restablecer</option>\r\n                                                </Form.Control>\r\n                                            </Form.Group>\r\n                                        </Form>\r\n                                    </Col>\r\n                                </Row>\r\n                                <label className=\"switch\">\r\n                                    <input type=\"checkbox\" onChange={ () => setToggleDate(!toggleDate) } />\r\n                                    <span className=\"slider round\"></span>\r\n                                </label>\r\n                                <br></br>\r\n                                {\r\n                                    toggleDate ?\r\n                                        <Table responsive=\"sm\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th>Lun</th>\r\n                                                <th>Mar</th>\r\n                                                <th>Mie</th>\r\n                                                <th>Jue</th>\r\n                                                <th>Vie</th>\r\n                                                <th>Sab</th>\r\n                                                <th>Dom</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            <tr>\r\n                                                <td><input className=\"checbokDias\" type=\"checkbox\" id=\"EditarReglaCheckboxLunes\"  /></td>\r\n                                                <td><input className=\"checbokDias\" type=\"checkbox\" id=\"EditarReglaCheckboxMartes\"  /></td>\r\n                                                <td><input className=\"checbokDias\" type=\"checkbox\" id=\"EditarReglaCheckboxMiercoles\"  /></td>\r\n                                                <td><input className=\"checbokDias\" type=\"checkbox\" id=\"EditarReglaCheckboxJueves\"  /></td>\r\n                                                <td><input className=\"checbokDias\" type=\"checkbox\" id=\"EditarReglaCheckboxViernes\"  /></td>\r\n                                                <td><input className=\"checbokDias\" type=\"checkbox\" id=\"EditarReglaCheckboxSabado\"  /></td>\r\n                                                <td><input className=\"checbokDias\" type=\"checkbox\" id=\"EditarReglaCheckboxDomingo\"  /></td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </Table>\r\n                                    :\r\n                                    <DatePicker\r\n                                        className=\"inputBlack\"\r\n                                        selected={startDate}\r\n                                        onChange={date => setStartDate(date)}\r\n                                    />\r\n                                }\r\n                                <br></br><br></br><br></br>\r\n                                <button onClick={ () => setEditarRegla(false) } style={{float:\"left\"}} >Cancelar</button>\r\n                                <button onClick={ (e) => updateJob(e) } style={{float:\"right\"}} >Agregar</button>\r\n                            </Card.Body>\r\n                        </Card>\r\n                    </Container>\r\n                :\r\n                    null\r\n            }\r\n        </>\r\n    );\r\n}\r\n\r\nexport default EditarRegla;","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Reglas\\VerUnidades.js",["176","177","178","179"],"import React, { useState } from 'react';\r\nimport { Card, Container, Row, Col } from 'react-bootstrap';\r\nimport { FaLock, FaSearch } from 'react-icons/fa';\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { updateUnitsJobsAction } from \"../../store/actions/tareasActions\";\r\n\r\nconst VerUnidades = ({setVerunidades,jobId}) => {\r\n\r\n    let unidades = useSelector(state => state.unidades.unidades);\r\n    let CMDS = useSelector(staet => staet.CMDS.unidadesCMDS);\r\n    const jobs = useSelector(state => state.tareas.tareas)\r\n    const job = jobs.filter(job => job.id === parseInt(jobId));\r\n    const [unidadesJobs,setUnidadesJobs] = useState(job[0].unidades);\r\n    const dispatch = useDispatch();\r\n    const unidadesFiltradas = () => {\r\n        const currentCMDS = [];\r\n        CMDS.map(unidadcmds => {\r\n            const Ccmds = unidadcmds.cmds.filter(cmd => cmd.n === job[0].comando && cmd.c === job[0].comandoTipo);\r\n            if (Ccmds.length > 0) {\r\n                currentCMDS.push({id:unidadcmds.id,nm:unidadcmds.n});\r\n            }\r\n        })\r\n        console.log(currentCMDS);\r\n        return currentCMDS;\r\n        \r\n    };\r\n    const unidadesFinal = unidadesFiltradas();\r\n    const [unidadesModal,setUnidadesModal] = useState(unidadesFiltradas());\r\n    const wialonObject = useSelector(state => state.usuario.user);\r\n\r\n    const buscarUnidadModal = e => {\r\n        e.preventDefault();\r\n        const nombre = e.target.value.toUpperCase();\r\n        let arrayUnidades = [];\r\n        unidadesFinal.map(unidad => {\r\n            if(unidad.nm.toUpperCase().search(nombre) !== -1)\r\n            {\r\n                arrayUnidades.push({\r\n                    id: unidad.id,\r\n                    nm: unidad.nm\r\n                })\r\n            }\r\n        });\r\n        console.log(arrayUnidades);\r\n        setUnidadesModal(arrayUnidades);\r\n    }\r\n    const drag = e => {\r\n        e.dataTransfer.setData(\"text\", e.target.id);\r\n    }\r\n    const allowDrop = e => {\r\n        e.preventDefault();\r\n    }\r\n    const drop = e => {\r\n        e.preventDefault();\r\n        const data = e.dataTransfer.getData(\"text\");\r\n        console.log(unidadesJobs);\r\n        var repite = unidadesJobs.filter(unidad => parseInt(data) === unidad );\r\n        console.log(repite);\r\n        if (repite.length <= 0) {\r\n            setUnidadesJobs([...unidadesJobs,parseInt(data)]);\r\n        }\r\n        console.log(unidades);\r\n        unidades.map(unidadJob => {\r\n            const UC = document.getElementById(\"checboxUnidad\" + unidadJob.id);\r\n            if (UC !== null) {\r\n                console.log(UC);\r\n                if (UC.checked) {\r\n                    repite = unidadesJobs.filter(unidad => parseInt(unidadJob.id) === unidad );\r\n                    if (repite.length <= 0) {\r\n                        setUnidadesJobs([...unidadesJobs,parseInt(unidadJob.id)]);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n    const dropUnidades = e => {\r\n        e.preventDefault();\r\n        \r\n        const data = e.dataTransfer.getData(\"text\");\r\n        let newGrupo = unidadesJobs.filter(grupo => grupo !== parseInt(data) )\r\n        unidadesJobs.map(unidad => {\r\n            const UC = document.getElementById(\"checboxUnidadJob\" + unidad).checked;\r\n            if (UC) {\r\n                newGrupo = newGrupo.filter(grupo => grupo !== parseInt(unidad) )\r\n            }\r\n        });\r\n        setUnidadesJobs(newGrupo);\r\n        \r\n    }\r\n\r\n    const guardarUnidadesTareas = e => {\r\n        e.preventDefault();\r\n        console.log(unidadesJobs);\r\n        console.log(jobId);\r\n        dispatch( updateUnitsJobsAction( jobId,unidadesJobs.join(),wialonObject ) );\r\n        \r\n    }\r\n    return ( \r\n        <Container className=\"popoverPanale\">\r\n            <Card style={{ width: '50rem', marginTop:\"10px\" }}>\r\n                <Card.Body>\r\n                    {/** */}\r\n                    <Row>\r\n                        <Col onDrop={(e) => dropUnidades(e)} onDragOver={(e) => allowDrop(e)}>\r\n                            <Card>\r\n                                <Card.Header>Unidades disponibles</Card.Header>\r\n                                <Card.Body style={{ maxHeight:\"500px\", overflowY:\"auto\"}} >\r\n                                    <Card.Title><input onChange={ e => buscarUnidadModal(e) } id=\"inputGroup-sizing-sm\" className=\"inputBlack\" /><FaSearch /></Card.Title>\r\n                                    <div id=\"UnidadesDiv\">\r\n                                        {\r\n                                            unidadesModal.map(unidad => (\r\n                                                <div \r\n                                                    key={\"Reglas_U\" + unidad.id} \r\n                                                    id={unidad.id} \r\n                                                    draggable=\"true\" \r\n                                                    style={{cursor: \"pointer\", borderStyle:\"outset\", marginTop:\"5px\"}} \r\n                                                    onDragStart={e => drag(e)}     \r\n                                                >\r\n                                                    <span><FaLock size={20} /> Unidad: {unidad.nm}</span>\r\n                                                    <input className=\"checbokUnidad\" id={\"checboxUnidad\"+unidad.id} type=\"checkbox\"  />\r\n                                                    <br></br>\r\n                                                </div>\r\n                                            ))\r\n                                        }\r\n                                    </div>\r\n                                </Card.Body>\r\n                            </Card>\r\n                        </Col>\r\n                        <Col onDrop={(e) => drop(e)} onDragOver={(e) => allowDrop(e)}>\r\n                            <Card >\r\n                                <Card.Header>Unidades tarea</Card.Header>\r\n                                <Card.Body style={{ maxHeight:\"500px\", overflowY:\"auto\"}} >\r\n                                    <div id=\"GrupoDiv\" >\r\n                                        {\r\n                                            unidadesJobs.map(unidad => (\r\n                                                <div \r\n                                                    key={\"Reglas_J\"+unidad} \r\n                                                    id={unidad} \r\n                                                    draggable=\"true\" \r\n                                                    style={{cursor: \"pointer\", borderStyle:\"outset\", marginTop:\"5px\"}}\r\n                                                    onDragStart={e => drag(e)} \r\n                                                >\r\n                                                    <span><FaLock size={20} /> Unidad: {\r\n                                                        \r\n                                                        unidades.filter(unidadG => (unidadG.id === unidad))[0].nm\r\n                                                    }</span>\r\n                                                    <input className=\"checbokUnidad\" id={\"checboxUnidadJob\"+unidad} type=\"checkbox\"  />\r\n                                                    <br></br>\r\n                                                </div>\r\n                                            ))\r\n                                        }\r\n                                    </div>\r\n                                </Card.Body>\r\n                            </Card>\r\n                        </Col>\r\n                    </Row>\r\n                    {/** */}\r\n                </Card.Body>\r\n                <Card.Footer>\r\n                        <button style={{float:\"right\"}} onClick={e => guardarUnidadesTareas(e)}>Guardar</button>\r\n                        <button style={{float:\"right\"}} onClick={() => setVerunidades(false)}>Cancelar</button>\r\n                </Card.Footer>\r\n            </Card>\r\n        </Container>\r\n     );\r\n}\r\n \r\nexport default VerUnidades;","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\actions\\usuarioActions.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\services\\AuthService.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\actions\\tareasActions.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\actions\\unidadesActions.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\actions\\CMDSActions.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\actions\\gruposActions.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\wialon\\session.js",["180","181"],"import W from 'wialonjs-api/dist/wialon-src'\r\nexport default class wialon {\r\n    session = null;\r\n    constructor(token){\r\n        this.token = token;\r\n        this.usuario = null;\r\n        this.unidades = [];\r\n        this.grupos = [];\r\n        this.sid = null;\r\n    }\r\n    login(callback){\r\n        let iniciar = new Promise((resolve, reject) => {\r\n            W.debug = true;\r\n            var self = this;\r\n            let session = self.session;\r\n            session = new W.Session('http://gps.intralix.com', {\r\n                eventsTimeout: 5\r\n            });\r\n            session\r\n                .on('lastMessageChanged', function() {\r\n                    //console.log('lastMessageChanged', arguments);\r\n                })\r\n                .on('positionChanged', function() {\r\n                    //console.log('positionChanged', arguments);\r\n                })\r\n                .on('itemChanged', function() {\r\n                    //console.log('itemChanged', arguments);\r\n                })\r\n                .on('itemDeleted', function() {\r\n                    //console.log('itemDeleted', arguments);\r\n                });\r\n            const StorageSID = localStorage.getItem('sid');\r\n            if (!StorageSID) {\r\n                session.execute('core/use_auth_hash', {authHash: this.token}, function(data) {\r\n                    var params = {\r\n                        params:{\"operateAs\":\"\",continueCurrentSession:true,checkService:\"auto.wialon_web.0\",restore:1,appName:\"myApp\"},\r\n                        sid:  session.getSid()\r\n                    }\r\n                    session.execute('core/duplicate', params, function(data) {\r\n                        //{\"operateAs\":\"\",\"continueCurrentSession\":true,\"checkService\":\"auto.wialon_web.0\",\"restore\":1,\"appName\":\"myApp\"}\r\n                        localStorage.setItem('sid', session.getSid());\r\n                        self.sid = session.getSid();\r\n                        self.usuario = data;\r\n                        /**inicio */\r\n                        var params = {spec:[{'type': 'type', 'data': 'avl_unit', 'flags': 0x401, 'mode': 0}]};\r\n                        // load items to current session\r\n                        session.execute('core/update_data_flags', params, function (data) {\r\n                            self.session = session;\r\n                            if (data.error) {\r\n                                reject(\"¡Error\");\r\n                                callback(data);\r\n                            } else {\r\n                                resolve(\"¡Éxito!\");\r\n                                callback(data);\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n            }else{\r\n                self.sid = StorageSID;\r\n                var params = {\r\n                    params:{\r\n                        \"operateAs\":\"\",\r\n                        \"continueCurrentSession\":true,\r\n                        \"checkService\":\"auto.wialon_web.0\",\r\n                        \"restore\":1,\r\n                        \"appName\":\"myApp\"\r\n                    },\r\n                    sid: self.sid\r\n                }\r\n                session.execute('core/duplicate', params, function(data) {\r\n                    localStorage.setItem('sid', session.getSid());\r\n                    self.sid = session.getSid();\r\n                    self.usuario = data;\r\n                    /**inicio */\r\n                    var params = {spec:[{'type': 'type', 'data': 'avl_unit', 'flags': 0x401, 'mode': 0}]};\r\n                    // load items to current session\r\n                    session.execute('core/update_data_flags', params, function (data) {\r\n                        self.session = session;\r\n                        if (data.error) {\r\n                            reject(\"¡Error\");\r\n                            callback(data);\r\n                        } else {\r\n                            resolve(\"¡Éxito!\");\r\n                            callback(data);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n\r\n        });\r\n\r\n        iniciar.then(() => {\r\n            //console.log(this.session);\r\n        });\r\n    }\r\n    showUnits(){\r\n        this.unidades = this.session.getItems() === undefined ? [] : this.session.getItems();\r\n        this.unidades.filter(unidad => (unidad.lmsg !== null || unidad.lmsg !== undefined))\r\n    }\r\n    getCMDS(callback){\r\n        //obtener lista de comandos\r\n        const self = this;\r\n        new Promise(()=>{\r\n            var params = {\r\n                \"params\" : [],\r\n                \"sid\": self.sid\r\n            }\r\n            self.unidades.forEach(unidad => {\r\n                params.params.push(\r\n                {\r\n                    \"svc\":\"core/search_item\",\r\n                    \"params\":{\r\n                        \"id\":unidad.id,\r\n                        \"flags\":4294967295\r\n                    }\r\n                })\r\n            });\r\n            self.session.execute('core/batch&sid=' + self.sid, params, function(data) {\r\n                console.log(\"cmds\");\r\n                console.log(data);\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    const unidadesCMDS = [];\r\n                    data.forEach(unidad => {\r\n                        if (unidad.item.cmds !== undefined) {\r\n                            const fecha = ( unidad.item.pos !== null ? obtenerFecha(unidad.item.pos.t) : \"00/00/0000\");\r\n                            unidadesCMDS.push({\r\n                                fecha:fecha,\r\n                                pos: unidad.item.pos,\r\n                                id:unidad.item.id,\r\n                                n:unidad.item.nm,\r\n                                cmds:unidad.item.cmds\r\n                            });\r\n                            /*\r\n                            unidad.item.cmds.forEach(comando => {\r\n                                if (comando.n === \"Posición\") {unidadesCMDS\r\n                                    console.log(unidad);\r\n                                    //console.log(unidad.item.nm);\r\n                                    console.log(comando);\r\n                                }\r\n                            });\r\n                            */\r\n                        }\r\n                    });\r\n                    callback(unidadesCMDS);\r\n                }\r\n            });\r\n        })\r\n    }\r\n    //\r\n    getJobs(callback){\r\n        const self = this;\r\n        new Promise(() => {\r\n            var params = {\r\n                params:{\r\n                    \"itemId\":105\r\n                }\r\n            };\r\n            self.session.execute('resource/get_job_data', params, function (data) {\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    const reglasArray = [];\r\n                    data = data.filter( job => job.act.t === \"exec_unit_cmd\" )\r\n                    data.forEach(tarea => {\r\n                        const id = tarea.id;\r\n                        const dias = obtenerDias(tarea.sch.w);\r\n                        const nombre = tarea.n;\r\n                        const comando = tarea.act.p.cmd_name;\r\n                        const comandoTipo = tarea.act.p.cmd_type;\r\n                        const unidades = obtenerUnidades(tarea.act.p.units);\r\n                        const hora = obtenerHora(tarea.r);\r\n                        const fecha = obtenerFecha(tarea.at);\r\n                        const estado = tarea.st.e;\r\n                        reglasArray.push({dias,nombre,comando,hora,unidades,estado,id,fecha,comandoTipo})\r\n                    });\r\n                    callback(reglasArray);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    editUnitsJob(id,unidades,callback){\r\n        const self = this;\r\n        new Promise(()=>{\r\n            //obtener la tarea\r\n            var params = {\r\n                params:{\r\n                    \"itemId\":105,\r\n                    \"col\":[id]\r\n                }\r\n            };\r\n            self.session.execute('resource/get_job_data', params, function (data) {\r\n                console.log(data);\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    //editar tarea\r\n                    data=data[0];\r\n                    const creatorId = self.usuario.user.id\r\n                    data.act.p.units = unidades;\r\n                    Object.assign(data, {itemId: 105,callMode:\"update\"});\r\n                    var params = {\r\n                        params:data\r\n                    };\r\n                    self.session.execute('resource/update_job', params, function (data) {\r\n                        console.log(data);\r\n                        if (data.error) {\r\n                            callback(data);\r\n                        } else {\r\n                            var params = {\r\n                                params:{\r\n                                    \"itemId\":105,\r\n                                    \"col\":[7,8]\r\n                                }\r\n                            };\r\n                            self.session.execute('resource/get_job_data', params, function (data) {\r\n                                if (data.error) {\r\n                                    callback(data);\r\n                                } else {\r\n                                    const reglasArray = [];\r\n                                    data.forEach(tarea => {\r\n                                        const id = tarea.id;\r\n                                        const dias = obtenerDias(tarea.sch.w);\r\n                                        const nombre = tarea.n;\r\n                                        const comando = tarea.act.p.cmd_name;\r\n                                        const comandoTipo = tarea.act.p.cmd_type;\r\n                                        const unidades = obtenerUnidades(tarea.act.p.units);\r\n                                        const hora = obtenerHora(tarea.r);\r\n                                        const fecha = obtenerFecha(tarea.at);\r\n                                        const estado = tarea.st.e;\r\n                                        reglasArray.push({dias,nombre,comando,hora,unidades,estado,id,fecha,comandoTipo})\r\n                                    });\r\n                                    callback(reglasArray);\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    };\r\n    editJob(id,nuevaTarea,callback){\r\n        const self = this;\r\n        new Promise(()=>{\r\n            //obtener la tarea\r\n            var params = {\r\n                params:{\r\n                    \"itemId\":105,\r\n                    \"col\":[id]\r\n                }\r\n            };\r\n            self.session.execute('resource/get_job_data', params, function (data) {\r\n                console.log(data);\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    //editar tarea\r\n                    data=data[0];\r\n                    const creatorId = self.usuario.user.id;\r\n                    //data.act.p.units = unidades;\r\n                    console.log(nuevaTarea);\r\n                    Object.assign(data, {itemId: 105,callMode:\"update\"});\r\n                    data.n = nuevaTarea.nombreTarea;\r\n                    data.r = \"1 \" + nuevaTarea.Hora;\r\n                    if (nuevaTarea.fecha !== null) data.at = nuevaTarea.fecha;\r\n                    if (nuevaTarea.arrayNuevosDias !== null) {\r\n                        const dias = formatoDiasTarea(nuevaTarea.arrayNuevosDias);\r\n                        data.sch.w = dias;\r\n                    }\r\n                    var params = {\r\n                        params:data\r\n                    };\r\n                    self.session.execute('resource/update_job', params, function (data) {\r\n                        console.log(data);\r\n                        if (data.error) {\r\n                            callback(data);\r\n                        } else {\r\n                            var params = {\r\n                                params:{\r\n                                    \"itemId\":105\r\n                                }\r\n                            };\r\n                            self.session.execute('resource/get_job_data', params, function (data) {\r\n                                if (data.error) {\r\n                                    callback(data);\r\n                                } else {\r\n                                    data = data.filter( job => job.act.t === \"exec_unit_cmd\" )\r\n                                    const reglasArray = [];\r\n                                    data.forEach(tarea => {\r\n                                        const id = tarea.id;\r\n                                        const dias = obtenerDias(tarea.sch.w);\r\n                                        const nombre = tarea.n;\r\n                                        const comando = tarea.act.p.cmd_name;\r\n                                        const comandoTipo = tarea.act.p.cmd_type;\r\n                                        const unidades = obtenerUnidades(tarea.act.p.units);\r\n                                        const hora = obtenerHora(tarea.r);\r\n                                        const fecha = obtenerFecha(tarea.at);\r\n                                        const estado = tarea.st.e;\r\n                                        reglasArray.push({dias,nombre,comando,hora,unidades,estado,id,fecha,comandoTipo})\r\n                                    });\r\n                                    callback(reglasArray);\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    }\r\n    createNewJob(nuevaTarea,callback){\r\n        const self = this;\r\n        new Promise(()=>{\r\n            var data = armarTarea(nuevaTarea);\r\n            console.log(data)\r\n            var params = {\r\n                params:data\r\n            };\r\n            self.session.execute('resource/update_job', params, function (data) {\r\n                console.log(data);\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    var params = {\r\n                        params:{\r\n                            \"itemId\":105\r\n                        }\r\n                    };\r\n                    self.session.execute('resource/get_job_data', params, function (data) {\r\n                        if (data.error) {\r\n                            callback(data);\r\n                        } else {\r\n                            data = data.filter( job => job.act.t === \"exec_unit_cmd\" )\r\n                            const reglasArray = [];\r\n                            data.forEach(tarea => {\r\n                                const id = tarea.id;\r\n                                const dias = obtenerDias(tarea.sch.w);\r\n                                const nombre = tarea.n;\r\n                                const comando = tarea.act.p.cmd_name;\r\n                                const comandoTipo = tarea.act.p.cmd_type;\r\n                                const unidades = obtenerUnidades(tarea.act.p.units);\r\n                                const hora = obtenerHora(tarea.r);\r\n                                const fecha = obtenerFecha(tarea.at);\r\n                                const estado = tarea.st.e;\r\n                                reglasArray.push({dias,nombre,comando,hora,unidades,estado,id,fecha,comandoTipo});\r\n                            });\r\n                            callback(reglasArray);\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    }\r\n    deleteJob(idJob,callback){\r\n        const self = this;\r\n        new Promise(()=>{\r\n            var params = {\r\n                params:{\r\n                    \"id\": idJob,\r\n                    \"itemId\": 105,\r\n                    \"callMode\": \"delete\"\r\n                }\r\n            };\r\n            self.session.execute('resource/update_job', params, function (data) {\r\n                console.log(data);\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    callback(data);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    deactivateJob(idJob,callback){\r\n        const self = this;\r\n        new Promise(()=>{\r\n            var params = {\r\n                params:{\r\n                    \"id\":idJob,\r\n                    \"e\":0,\r\n                    \"itemId\":105,\r\n                    \"callMode\":\"enable\"\r\n                }\r\n            };\r\n            self.session.execute('resource/update_job', params, function (data) {\r\n                console.log(data);\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    callback(data);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    activateJob(idJob,callback){\r\n        const self = this;\r\n        new Promise(()=>{\r\n            var params = {\r\n                params:{\r\n                    \"id\":idJob,\r\n                    \"e\":1,\r\n                    \"itemId\":105,\r\n                    \"callMode\":\"enable\"\r\n                }\r\n            };\r\n            self.session.execute('resource/update_job', params, function (data) {\r\n                console.log(data);\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    callback(data);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    //\r\n    showGroups(callback){\r\n        const self = this;\r\n        new Promise(() => {\r\n            var params = {spec:[{'type': 'type', 'data': 'avl_unit_group', 'flags': 0x411, 'mode': 1}]};\r\n            this.session.execute('core/update_data_flags', params, function (data) {\r\n                self.grupos = data;\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    callback(data);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    addUnitsGroup(units,IdGroup,callback){\r\n        new Promise(() => {\r\n            const self = this;\r\n            var req = new W.Request('http://gps.intralix.com');\r\n            var params = {\r\n                \"params\":{\r\n                    \"itemId\": IdGroup, \r\n                    \"units\": units\r\n                },\r\n                \"sid\":self.sid\r\n            };\r\n            req.api('unit_group/update_units&sid=' + self.sid, params, function(data) {\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    let groups = self.session.getItems(\"avl_unit_group\");\r\n                    groups = groups.filter(grupo => (grupo.nm === \"Admin\" || grupo.nm === \"Grupo Desarrollo\") );\r\n                    callback(groups);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    createGroup(units,name,callback){\r\n        new Promise(() => {\r\n            const self = this;\r\n            console.log(self.usuario.user.id);\r\n            const creatorId = self.usuario.user.id\r\n            var req = new W.Request('http://gps.intralix.com');\r\n            var params = {\r\n                \"params\":{\r\n                    \"creatorId\": creatorId, \r\n                    \"name\": name,\r\n                    \"dataFlags\": 1\r\n                },\r\n                \"sid\":self.sid\r\n            };\r\n            req.api('core/create_unit_group&sid=' + self.sid, params, function(data) {\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    callback(data);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    addUnitsNewGroup(units,IdGroup,callback){\r\n        new Promise(() => {\r\n            const self = this;\r\n            var req = new W.Request('http://gps.intralix.com');\r\n            var params = {\r\n                \"params\":{\r\n                    \"itemId\": IdGroup, \r\n                    \"units\": units\r\n                },\r\n                \"sid\":self.sid\r\n            };\r\n            req.api('unit_group/update_units&sid=' + self.sid, params, function(data) {\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    callback(data);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    deleteGroup(IdGroup,callback){\r\n        new Promise(() => {\r\n            const self = this;\r\n            var req = new W.Request('http://gps.intralix.com');\r\n            var params = {\r\n                \"params\":{\r\n                    'itemId': IdGroup\r\n                },\r\n                \"sid\":self.sid\r\n            };\r\n            req.api('item/delete_item&sid=' + self.sid, params, function(data) {\r\n                if (data.error) {\r\n                    callback(data);\r\n                } else {\r\n                    callback(data);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    enviarComando(unidades,comandoString,callback){\r\n        const self = this;\r\n        new Promise(() => {\r\n            var params = {\r\n                \"params\" : [],\r\n                \"sid\": self.sid\r\n            }\r\n            unidades.forEach(unidad => {\r\n                params.params.push(\r\n                    {\r\n                        \"svc\":\"unit/exec_cmd\",\r\n                        \"params\":{\r\n                            \"itemId\":unidad,\r\n                            \"commandName\":comandoString,\r\n                            \"linkType\" : \"\",\r\n                            \"param\" : \"\",\r\n                            \"timeout\":0,\r\n                            \"flags\":1\r\n                        }\r\n                    })\r\n            });\r\n            self.session.execute('core/batch&sid=' + self.sid, params, function(data) {\r\n                const arrayError = [];\r\n                for (let i = 0; i < data.length; i++) {\r\n                    const respuesta = data[i];\r\n                    const unidad = unidades[i];\r\n                    if(respuesta.error){\r\n                        arrayError.push(unidad);\r\n                    }\r\n                }\r\n                if (data.error) {\r\n                    callback(data,arrayError);\r\n                } else {\r\n                    callback(data,arrayError);\r\n                }\r\n            });\r\n        });\r\n    }\r\n}\r\nconst armarTarea = (tarea) => {\r\n    let dias = 0;\r\n    if (tarea.arrayNuevosDias.length > 0) {\r\n        dias = formatoDiasTarea(tarea.arrayNuevosDias);\r\n    }\r\n    var local = new Date();\r\n    var utc = Date.UTC(local.getFullYear(), local.getMonth(), local.getDate(), local.getHours(), local.getMinutes(), local.getSeconds(), local.getMilliseconds());\r\n    var tz = (utc - local.getTime());\r\n    //console.log(utc - local.getTime());\r\n    const tareaNueva = {\r\n        \"n\": tarea.nombreTarea,\r\n        \"d\": tarea.nombreTarea + \" creada desde portal de chapas\",\r\n        \"r\": \"1 \"+tarea.Hora,\r\n        \"at\": tarea.fecha,\r\n        \"tz\": tz,       //verificar\r\n        \"l\": \"es\",\r\n        \"e\": 1,\r\n        \"m\": 0,\r\n        \"sch\": {\r\n            \"f1\": 0,\r\n            \"f2\": 0,\r\n            \"t1\": 0,\r\n            \"t2\": 0,\r\n            \"m\": 0,\r\n            \"y\": 0,\r\n            \"w\": dias          //dias a la semana que se repite\r\n        },\r\n        \"act\": {\r\n            \"t\": \"exec_unit_cmd\",\r\n            \"p\": {\r\n                \"units\": tarea.unidades.join(),\r\n                \"cmd_name\": tarea.cmd.cmd_name,\r\n                \"cmd_type\": tarea.cmd.cmd_type,\r\n                \"cmd_param\": tarea.cmd.cmd_param,\r\n                \"link_type\": \"\",\r\n                \"timeout\": 60\r\n            }\r\n        },\r\n        \"id\": 0,\r\n        \"itemId\": 105,\r\n        \"callMode\": \"create\"\r\n    };\r\n    return tareaNueva;\r\n}\r\nconst obtenerFecha = (fecha) => {\r\n    var a = new Date(fecha * 1000);\r\n    var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\r\n    var year = a.getFullYear();\r\n    var month = months[a.getMonth()];\r\n    var date = a.getDate();\r\n    var time = date + ' ' + month + ' ' + year;\r\n    return time;\r\n}\r\n\r\nconst obtenerUnidades = (unidades) => {\r\n    var unidadesArr = unidades.split(',');\r\n    const unidadesR = [];\r\n    unidadesArr.forEach(element => {\r\n        unidadesR.push(parseInt(element))\r\n    });\r\n    return unidadesR;\r\n}\r\nconst obtenerHora = (hora) => {\r\n    var date = hora.substr(2, hora.length);\r\n    return date;\r\n}\r\nconst obtenerDias = (diasJob) => {\r\n    const arrayDias = [];\r\n    arrayDiasJobs.forEach(dia => {\r\n        const diaTemp = diasJob - dia[1];\r\n        if (diaTemp >= 0) {\r\n            arrayDias.push(dia[0]);\r\n            diasJob = diaTemp;\r\n        }\r\n    });\r\n    return arrayDias;\r\n}\r\nconst formatoDiasTarea = (diasJob) => {\r\n    let contadorDias = 0;\r\n    diasJob.forEach(dia => {\r\n        arrayDiasJobs.forEach(DJ => {\r\n            if (dia === DJ[0]) {\r\n                contadorDias += DJ[1];\r\n            }\r\n        });\r\n    });\r\n    return contadorDias;\r\n}\r\nconst arrayDiasJobs = [\r\n    [\"Domingo\",64],\r\n    [\"Sabado\",35],\r\n    [\"Viernes\",16],\r\n    [\"Jueves\",8],\r\n    [\"Miercoles\",4],\r\n    [\"Martes\",2],\r\n    [\"Lunes\",1]\r\n]\r\n\r\n\r\n//Invoke-WebRequest -Uri \"http://gps.intralix.com/wialon/ajax.html?svc=resource/update_job&sid=1f7b5888b31f65221c3ff2a37d9a6243\" `\r\n//-Method \"POST\" `\r\n//-Headers @{\r\n//\"User-Agent\"=\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36\"\r\n//  \"Accept\"=\"*/*\"\r\n//  \"Origin\"=\"http://gps.intralix.com\"\r\n//  \"Referer\"=\"http://gps.intralix.com/wialon/post.html\"\r\n//  \"Accept-Encoding\"=\"gzip, deflate\"\r\n//  \"Accept-Language\"=\"es-419,es;q=0.9,en;q=0.8\"\r\n//  \"Cookie\"=\"_gcl_au=1.1.1601771906.1607701582; _ym_d=1611953260; _ym_uid=1611953260214380465; lang=es; _ga=GA1.1.1504113298.1607701583; _ga_KGT7H4QD6P=GS1.1.1613601284.4.0.1613601291.53; wwp=; _ym_isad=2; sessions=888eeae6ad0ca653329fe58520245d5b%2C44c7832d07bce0ab9e7f57129fc45544%2C1f7b5888b31f65221c3ff2a37d9a6243\"\r\n//} `\r\n//-ContentType \"application/x-www-form-urlencoded\" `\r\n//-Body \"params=%7B%22n%22%3A%22Posici%C3%B3n%20Desarrollo%22%2C%22d%22%3A%22tarea%20prueba%20desarrollo%22%2C%22r%22%3A%222%2018000%22%2C%22at%22%3A1613714400%2C%22tz%22%3A-100160608%2C%22l%22%3A%22es%22%2C%22e%22%3A1%2C%22m%22%3A0%2C%22sch%22%3A%7B%22f1%22%3A0%2C%22f2%22%3A0%2C%22t1%22%3A0%2C%22t2%22%3A0%2C%22m%22%3A0%2C%22y%22%3A0%2C%22w%22%3A0%7D%2C%22act%22%3A%7B%22t%22%3A%22exec_unit_cmd%22%2C%22p%22%3A%7B%22units%22%3A%221734%22%2C%22cmd_name%22%3A%22Posici%C3%B3n%22%2C%22cmd_type%22%3A%22custom_msg%22%2C%22cmd_param%22%3A%22AT%2BGTRTO%3Dgv55w%2C1%2C%2C0%2C%2C%2C%2CFFFF%24%22%2C%22link_type%22%3A%22%22%2C%22timeout%22%3A60%7D%7D%2C%22id%22%3A0%2C%22itemId%22%3A105%2C%22callMode%22%3A%22create%22%7D&sid=1f7b5888b31f65221c3ff2a37d9a6243\"\r\n\r\n/*\r\nrequest\r\n{\r\n    \"n\": \"Posición Desarrollo\",\r\n    \"d\": \"tarea prueba desarrollo\",\r\n    \"r\": \"2 18000\",\r\n    \"at\": 1613714400,\r\n    \"tz\": -100160608,\r\n    \"l\": \"es\",\r\n    \"e\": 1,\r\n    \"m\": 0,\r\n    \"sch\": {\r\n      \"f1\": 0,\r\n      \"f2\": 0,\r\n      \"t1\": 0,\r\n      \"t2\": 0,\r\n      \"m\": 0,\r\n      \"y\": 0,\r\n      \"w\": 0\r\n    },\r\n    \"act\": {\r\n      \"t\": \"exec_unit_cmd\",\r\n      \"p\": {\r\n        \"units\": \"1734\",\r\n        \"cmd_name\": \"Posición\",\r\n        \"cmd_type\": \"custom_msg\",\r\n        \"cmd_param\": \"AT+GTRTO=gv55w,1,,0,,,,FFFF$\",\r\n        \"link_type\": \"\",\r\n        \"timeout\": 60\r\n      }\r\n    },\r\n    \"id\": 0,\r\n    \"itemId\": 105,\r\n    \"callMode\": \"create\"\r\n  }\r\n*/  \r\n/**\r\n * response\r\n[\r\n  7,\r\n  {\r\n    \"id\": 7,\r\n    \"n\": \"Posición Desarrollo\",\r\n    \"d\": \"tarea prueba desarrollo\",\r\n    \"m\": 0,\r\n    \"st\": {\r\n      \"e\": 1,\r\n      \"c\": 0,\r\n      \"l\": 0\r\n    },\r\n    \"act\": \"exec_unit_cmd\",\r\n    \"ct\": 1613757698,\r\n    \"mt\": 1613757698\r\n  }\r\n]\r\n */\r\n\r\n /**varios dias (lunes, miercoles, jueves)\r\n  * request\r\n{\r\n  \"n\": \"Posición desarrollo 2\",\r\n  \"d\": \"Tarea desarrollo 2 unidades\",\r\n  \"r\": \"1 12:00\",\r\n  \"at\": 1613714400,\r\n  \"tz\": -100160608,\r\n  \"l\": \"es\",\r\n  \"e\": 1,\r\n  \"m\": 0,\r\n  \"sch\": {\r\n    \"f1\": 0,\r\n    \"f2\": 0,\r\n    \"t1\": 0,\r\n    \"t2\": 0,\r\n    \"m\": 0,\r\n    \"y\": 0,\r\n    \"w\": 13\r\n  },\r\n  \"act\": {\r\n    \"t\": \"exec_unit_cmd\",\r\n    \"p\": {\r\n      \"units\": \"1028,1447\",\r\n      \"cmd_name\": \"Posición\",\r\n      \"cmd_type\": \"query_pos\",\r\n      \"cmd_param\": \"AT+GTRTO=gv55w,1,,0,,,,FFFF$\",\r\n      \"link_type\": \"\",\r\n      \"timeout\": 60\r\n    }\r\n  },\r\n  \"id\": 0,\r\n  \"itemId\": 105,\r\n  \"callMode\": \"create\"\r\n}\r\n  */\r\n /**\r\n  * response\r\n[\r\n  8,\r\n  {\r\n    \"id\": 8,\r\n    \"n\": \"Posición desarrollo 2\",\r\n    \"d\": \"Tarea desarrollo 2 unidades\",\r\n    \"m\": 0,\r\n    \"st\": {\r\n      \"e\": 1,\r\n      \"c\": 0,\r\n      \"l\": 0\r\n    },\r\n    \"act\": \"exec_unit_cmd\",\r\n    \"ct\": 1613774353,\r\n    \"mt\": 1613774353\r\n  }\r\n]\r\n  */","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\usuarioReducer.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\tareasReducer.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\unidadesReducer.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\gruposReducer.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\reducers\\CMDSReducer.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\components\\DesktopContainer.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\UnidadesMapa.js",["182","183"],"import React, { useState } from 'react';\r\nimport { useSelector } from \"react-redux\";\r\nimport { Marker, Popup } from 'react-leaflet'\r\n\r\nconst UnidadesMapa = () => {\r\n\r\n    const jobs = useSelector(state => state.tareas.tareas);\r\n    const temp = jobs.find(job => job.id === 20);\r\n    console.log(temp)\r\n    //3657\r\n    const CMDSUnidades = useSelector(state => state.CMDS.unidadesCMDS);\r\n    let unidades = useSelector(state => state.unidades.unidades);\r\n    unidades = unidades.map(unidad => {\r\n        const unidadCcmd = CMDSUnidades.find(unidadcmd => unidadcmd.id === unidad.id);\r\n        if (unidadCcmd !== undefined) {\r\n            return unidad;\r\n        }\r\n    });\r\n    unidades= unidades.filter( unidad => unidad !== undefined);\r\n    const [unidadesModal] = useState(CMDSUnidades);\r\n    return (\r\n    <>\r\n        {\r\n            unidadesModal.map(unidad => (\r\n                unidad.pos !== null ?\r\n                    (<Marker key={unidad.id + \"M\"} position={[unidad.pos.y,unidad.pos.x]}>\r\n                        <Popup className=\"popupContainer\" >\r\n                            <div className='popupMarker'>\r\n                                Unidad: {unidad.n}\r\n                                <br></br><br></br>\r\n                                <table className=\"table\">\r\n                                    <thead>\r\n                                    <tr>\r\n                                        <th scope=\"col\">Dirección</th>\r\n                                        <th scope=\"col\">Fecha</th>\r\n                                    </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                    <tr>\r\n                                        <td>direccion</td>\r\n                                        <td>{unidad.fecha}</td>\r\n                                    </tr>\r\n                                    </tbody>\r\n                                </table>\r\n                                Tareas\r\n                                <table className=\"table\">\r\n                                    <thead>\r\n                                    <tr>\r\n                                        <th scope=\"col\">Nombre</th>\r\n                                        <th scope=\"col\">Hora</th>\r\n                                        <th scope=\"col\">Recurrencia</th>\r\n                                        <th scope=\"col\">Comando</th>\r\n                                    </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                    {\r\n                                        jobs.map( job => {\r\n                                            return (\r\n                                                job.unidades.find(unidadJob => unidad.id === unidadJob) !== undefined ?\r\n                                                    <tr>\r\n                                                        <td>{job.nombre}</td>\r\n                                                        <td>{job.hora}</td>\r\n                                                        {\r\n                                                            job.dias.length > 0 ?\r\n                                                            <td>{job.dias.join(\", \")}</td>\r\n                                                            :\r\n                                                            <td>fechas</td>\r\n                                                        }\r\n                                                        <td>{job.comando}</td>\r\n                                                    </tr>\r\n                                                :\r\n                                                    null\r\n                                            )\r\n                                        })\r\n                                    }\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </Popup>\r\n                    </Marker>)\r\n                :\r\n                    null\r\n            ))\r\n        }\r\n    </>\r\n    );\r\n}\r\nexport default UnidadesMapa;","C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\config\\errores.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\store\\types\\index.js",[],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\pages\\Menu.js",["184","185","186","187","188"],"C:\\Users\\Oscar Perez\\Documents\\trabajo\\chapas\\wialon_api_main\\src\\config\\CMDS.js",[],{"ruleId":"189","replacedBy":"190"},{"ruleId":"191","replacedBy":"192"},{"ruleId":"193","severity":1,"message":"194","line":20,"column":5,"nodeType":"195","endLine":20,"endColumn":7,"suggestions":"196"},{"ruleId":"197","severity":1,"message":"198","line":69,"column":15,"nodeType":"199","endLine":69,"endColumn":38},{"ruleId":"200","severity":1,"message":"201","line":9,"column":34,"nodeType":"202","messageId":"203","endLine":9,"endColumn":36},{"ruleId":"193","severity":1,"message":"204","line":31,"column":8,"nodeType":"195","endLine":31,"endColumn":16,"suggestions":"205"},{"ruleId":"200","severity":1,"message":"206","line":42,"column":34,"nodeType":"202","messageId":"207","endLine":42,"endColumn":36},{"ruleId":"200","severity":1,"message":"206","line":58,"column":34,"nodeType":"202","messageId":"207","endLine":58,"endColumn":36},{"ruleId":"200","severity":1,"message":"206","line":120,"column":33,"nodeType":"202","messageId":"207","endLine":120,"endColumn":35},{"ruleId":"208","severity":1,"message":"209","line":21,"column":11,"nodeType":"210","messageId":"211","endLine":21,"endColumn":18},{"ruleId":"200","severity":1,"message":"201","line":26,"column":41,"nodeType":"202","messageId":"203","endLine":26,"endColumn":43},{"ruleId":"200","severity":1,"message":"201","line":27,"column":52,"nodeType":"202","messageId":"203","endLine":27,"endColumn":54},{"ruleId":"208","severity":1,"message":"212","line":54,"column":12,"nodeType":"210","messageId":"211","endLine":54,"endColumn":29},{"ruleId":"193","severity":1,"message":"213","line":65,"column":8,"nodeType":"195","endLine":65,"endColumn":14,"suggestions":"214"},{"ruleId":"215","severity":1,"message":"216","line":84,"column":21,"nodeType":"210","messageId":"217","endLine":84,"endColumn":26},{"ruleId":"215","severity":1,"message":"218","line":85,"column":25,"nodeType":"210","messageId":"217","endLine":85,"endColumn":26},{"ruleId":"215","severity":1,"message":"216","line":105,"column":29,"nodeType":"210","messageId":"217","endLine":105,"endColumn":34},{"ruleId":"215","severity":1,"message":"218","line":106,"column":33,"nodeType":"210","messageId":"217","endLine":106,"endColumn":34},{"ruleId":"200","severity":1,"message":"206","line":166,"column":30,"nodeType":"202","messageId":"207","endLine":166,"endColumn":32},{"ruleId":"197","severity":1,"message":"198","line":385,"column":29,"nodeType":"199","endLine":385,"endColumn":52},{"ruleId":"200","severity":1,"message":"201","line":14,"column":37,"nodeType":"202","messageId":"203","endLine":14,"endColumn":39},{"ruleId":"200","severity":1,"message":"201","line":15,"column":48,"nodeType":"202","messageId":"203","endLine":15,"endColumn":50},{"ruleId":"200","severity":1,"message":"206","line":87,"column":26,"nodeType":"202","messageId":"207","endLine":87,"endColumn":28},{"ruleId":"193","severity":1,"message":"219","line":32,"column":8,"nodeType":"195","endLine":32,"endColumn":10,"suggestions":"220"},{"ruleId":"200","severity":1,"message":"206","line":17,"column":29,"nodeType":"202","messageId":"207","endLine":17,"endColumn":31},{"ruleId":"200","severity":1,"message":"206","line":35,"column":34,"nodeType":"202","messageId":"207","endLine":35,"endColumn":36},{"ruleId":"200","severity":1,"message":"206","line":63,"column":32,"nodeType":"202","messageId":"207","endLine":63,"endColumn":34},{"ruleId":"200","severity":1,"message":"206","line":81,"column":33,"nodeType":"202","messageId":"207","endLine":81,"endColumn":35},{"ruleId":"208","severity":1,"message":"221","line":201,"column":27,"nodeType":"210","messageId":"211","endLine":201,"endColumn":36},{"ruleId":"208","severity":1,"message":"221","line":261,"column":27,"nodeType":"210","messageId":"211","endLine":261,"endColumn":36},{"ruleId":"200","severity":1,"message":"201","line":13,"column":36,"nodeType":"202","messageId":"203","endLine":13,"endColumn":38},{"ruleId":"208","severity":1,"message":"222","line":19,"column":15,"nodeType":"210","messageId":"211","endLine":19,"endColumn":23},{"ruleId":"208","severity":1,"message":"223","line":5,"column":10,"nodeType":"210","messageId":"211","endLine":5,"endColumn":15},{"ruleId":"208","severity":1,"message":"224","line":5,"column":17,"nodeType":"210","messageId":"211","endLine":5,"endColumn":23},{"ruleId":"208","severity":1,"message":"225","line":5,"column":25,"nodeType":"210","messageId":"211","endLine":5,"endColumn":33},{"ruleId":"197","severity":1,"message":"198","line":75,"column":13,"nodeType":"199","endLine":75,"endColumn":95},{"ruleId":"197","severity":1,"message":"198","line":77,"column":13,"nodeType":"199","endLine":77,"endColumn":86},"no-native-reassign",["226"],"no-negated-in-lhs",["227"],"react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'dispatch' and 'history'. Either include them or remove the dependency array.","ArrayExpression",["228"],"jsx-a11y/alt-text","img elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","JSXOpeningElement","array-callback-return","Array.prototype.map() expects a value to be returned at the end of arrow function.","ArrowFunctionExpression","expectedAtEnd","React Hook useEffect has missing dependencies: 'cofirmDelete' and 'loadingEquipos'. Either include them or remove the dependency array.",["229"],"Array.prototype.map() expects a return value from arrow function.","expectedInside","no-unused-vars","'usuario' is assigned a value but never used.","Identifier","unusedVar","'comandoNuevaRegla' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'jobsModal'. Either include it or remove the dependency array. You can also do a functional update 'setJobsModal(j => ...)' if you only need 'jobsModal' in the 'setJobsModal' call.",["230"],"no-redeclare","'total' is already defined.","redeclared","'i' is already defined.","React Hook useEffect has a missing dependency: 'job'. Either include it or remove the dependency array.",["231"],"'creatorId' is assigned a value but never used.","'unidades' is assigned a value but never used.","'FaCog' is defined but never used.","'FaLock' is defined but never used.","'FaWrench' is defined but never used.","no-global-assign","no-unsafe-negation",{"desc":"232","fix":"233"},{"desc":"234","fix":"235"},{"desc":"236","fix":"237"},{"desc":"238","fix":"239"},"Update the dependencies array to be: [dispatch, history]",{"range":"240","text":"241"},"Update the dependencies array to be: [cofirmDelete, grupos, loadingEquipos]",{"range":"242","text":"243"},"Update the dependencies array to be: [jobs, jobsModal]",{"range":"244","text":"245"},"Update the dependencies array to be: [job]",{"range":"246","text":"247"},[527,529],"[dispatch, history]",[1566,1574],"[cofirmDelete, grupos, loadingEquipos]",[2916,2922],"[jobs, jobsModal]",[1459,1461],"[job]"]